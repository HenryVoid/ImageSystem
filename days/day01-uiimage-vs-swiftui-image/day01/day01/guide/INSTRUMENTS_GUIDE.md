# 6) Instrumentsì—ì„œ "ì •ë‹µ" ë½‘ê¸° (Step-by-step)

> ğŸ“Š **ë¶„ì„ ê²°ê³¼**: [ANALYSIS_RESULTS.md](./ANALYSIS_RESULTS.md) íŒŒì¼ì„ ì°¸ê³ í•˜ì„¸ìš”.

---

## ğŸ“± ì‚¬ì „ ì¤€ë¹„

### 1ë‹¨ê³„: ì‹¤ê¸°ê¸° ì—°ê²°
- iPhoneì„ Macì— USBë¡œ ì—°ê²°
- Xcodeì—ì„œ íƒ€ê²Ÿ ë””ë°”ì´ìŠ¤ ì„ íƒ
- ê°œë°œì ëª¨ë“œ í™œì„±í™” í™•ì¸

### 2ë‹¨ê³„: Release ëª¨ë“œë¡œ ë¹Œë“œ
```
Xcode > Product > Scheme > Edit Scheme...
Run > Info > Build Configuration > Release
```
âš ï¸ **ì¤‘ìš”**: Debug ëª¨ë“œëŠ” ìµœì í™”ê°€ êº¼ì ¸ìˆì–´ ì„±ëŠ¥ì´ ì‹¤ì œë³´ë‹¤ ë‚˜ì˜ê²Œ ë‚˜ì˜µë‹ˆë‹¤!

---

## ğŸ”¬ Instruments ì‹¤í–‰

### ë°©ë²• 1: Xcodeì—ì„œ ì§ì ‘
```
Xcode > Product > Profile (âŒ˜I)
```

### ë°©ë²• 2: Instruments ì•± ì§ì ‘ ì‹¤í–‰
```
Applications > Xcode > Contents > Applications > Instruments.app
```

---

## ğŸ“Š ì£¼ìš” ì¸¡ì • í•­ëª©ë³„ ê°€ì´ë“œ

### 1ï¸âƒ£ Time Profiler (CPU ì‚¬ìš©ë¥ )

**ëª©ì **: SwiftUI vs UIKit ì¤‘ ì–´ëŠ ìª½ì´ CPUë¥¼ ë§ì´ ì“°ëŠ”ì§€

**ì‹¤í–‰ ë°©ë²•**:
1. Instruments í…œí”Œë¦¿ì—ì„œ "Time Profiler" ì„ íƒ
2. íƒ€ê²Ÿ ë””ë°”ì´ìŠ¤ì™€ ì•± ì„ íƒ
3. ë…¹í™” ë²„íŠ¼ (ë¹¨ê°„ ì ) í´ë¦­
4. ì•±ì—ì„œ SwiftUI íƒ­ â†’ ìŠ¤í¬ë¡¤ â†’ 10ì´ˆ ëŒ€ê¸°
5. ì•±ì—ì„œ UIKit íƒ­ â†’ ìŠ¤í¬ë¡¤ â†’ 10ì´ˆ ëŒ€ê¸°
6. ì •ì§€ ë²„íŠ¼ í´ë¦­

**ë¶„ì„ ë°©ë²•**:
```
1. Call Tree ì˜µì…˜ ì„¤ì •:
   âœ… Separate by Thread
   âœ… Hide System Libraries
   âœ… Flatten Recursion

2. Main Thread ì°¾ê¸°
3. í•¨ìˆ˜ë³„ CPU ì‹œê°„ í™•ì¸
   - SwiftUI: Image(uiImage:) ê´€ë ¨ í•¨ìˆ˜ë“¤
   - UIKit: UIImageView ê´€ë ¨ í•¨ìˆ˜ë“¤

4. ë¹„êµ ì§€í‘œ:
   - Total Time (ms)
   - % of Runtime
```

---

### 2ï¸âƒ£ os_signpost (ì»¤ìŠ¤í…€ êµ¬ê°„ ì¸¡ì •)

**ëª©ì **: ìš°ë¦¬ê°€ ì½”ë“œì— ì‹¬ì–´ë‘” ì‚¬ì¸í¬ìŠ¤íŠ¸ë¡œ ì •í™•í•œ êµ¬ê°„ ì¸¡ì •

**ì‹¤í–‰ ë°©ë²•**:
1. "os_signpost" í…œí”Œë¦¿ ì„ íƒ
2. ë…¹í™” ì‹œì‘
3. ìŠ¤í¬ë¡¤ í…ŒìŠ¤íŠ¸
4. ì •ì§€

**ë¶„ì„ ë°©ë²•**:
```
ì¢Œì¸¡ íŒ¨ë„ì—ì„œ:
ğŸ“ SwiftUI_Scroll
ğŸ“ UIKit_Scroll
ğŸ“ SwiftUI_Render
ğŸ“ UIKit_Render

ê° êµ¬ê°„ì˜ Duration(ms) í™•ì¸!

ğŸ’¡ íŒ: Summary ë·°ì—ì„œ í‰ê· /ìµœì†Œ/ìµœëŒ€ í™•ì¸ ê°€ëŠ¥
```

**ğŸ“Š ë¶„ì„ ê²°ê³¼ëŠ” [ANALYSIS_RESULTS.md](./ANALYSIS_RESULTS.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.**

---

### 3ï¸âƒ£ Allocations (ë©”ëª¨ë¦¬ í• ë‹¹)

**ëª©ì **: ì´ë¯¸ì§€ ë¡œë”© ì‹œ ë©”ëª¨ë¦¬ ì–¼ë§ˆë‚˜ ë¨¹ëŠ”ì§€

**ì‹¤í–‰ ë°©ë²•**:
1. "Allocations" í…œí”Œë¦¿ ì„ íƒ
2. ë…¹í™” ì‹œì‘ â†’ ì•± ì‹œì‘ â†’ ìŠ¤í¬ë¡¤
3. Generation Analysis í™œìš©

**ë¶„ì„ ë°©ë²•**:
```
1. Statistics íƒ­:
   - UIImage ê²€ìƒ‰
   - Persistent Bytes (ì§€ì† ë©”ëª¨ë¦¬)
   - Transient Bytes (ì„ì‹œ ë©”ëª¨ë¦¬)

2. Call Treeì—ì„œ:
   - UIImage.init í˜¸ì¶œ ë¹ˆë„
   - ë©”ëª¨ë¦¬ ì¦ê°€ëŸ‰

3. ë¹„êµ:
   SwiftUI Image vs UIKit UIImageView
   ëˆ„ê°€ ë©”ëª¨ë¦¬ë¥¼ ë” íš¨ìœ¨ì ìœ¼ë¡œ ì“°ëŠ”ê°€?
```

**ğŸ“Š ë¶„ì„ ê²°ê³¼ëŠ” [ANALYSIS_RESULTS.md](./ANALYSIS_RESULTS.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.**

---

### 4ï¸âƒ£ Leaks (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜)

**ëª©ì **: ì´ë¯¸ì§€ ì œê±° í›„ì—ë„ ë©”ëª¨ë¦¬ê°€ ì•ˆ ì‚¬ë¼ì§€ëŠ”ì§€ í™•ì¸

**ì‹¤í–‰ ë°©ë²•**:
1. "Leaks" í…œí”Œë¦¿ ì„ íƒ
2. ë…¹í™” â†’ ìŠ¤í¬ë¡¤ â†’ íƒ­ ì „í™˜ ë°˜ë³µ
3. Leaks ìë™ ìŠ¤ìº” ê²°ê³¼ í™•ì¸

**ë¶„ì„**:
```
âŒ ë¹¨ê°„ X í‘œì‹œê°€ ìˆìœ¼ë©´ ëˆ„ìˆ˜!
âœ… ì—†ìœ¼ë©´ OK

ëˆ„ìˆ˜ê°€ ìˆë‹¤ë©´:
- Call Stack í™•ì¸
- ì–´ëŠ ì´ë¯¸ì§€ ë¡œë”© ì½”ë“œê°€ ì›ì¸ì¸ì§€ ì¶”ì 
```

**ğŸ“Š ë¶„ì„ ê²°ê³¼ëŠ” [ANALYSIS_RESULTS.md](./ANALYSIS_RESULTS.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.**

---

### 5ï¸âƒ£ System Trace (ì¢…í•© ë¶„ì„)

**ëª©ì **: CPU, GPU, ë©”ëª¨ë¦¬, ìŠ¤ë ˆë“œ ë“± ëª¨ë“  ê²ƒì„ í•œëˆˆì—

**ì‹¤í–‰ ë°©ë²•**:
1. "System Trace" í…œí”Œë¦¿
2. ë…¹í™” â†’ í…ŒìŠ¤íŠ¸
3. íƒ€ì„ë¼ì¸ ë¶„ì„

**ë¶„ì„**:
```
ğŸ“Š íƒ€ì„ë¼ì¸ì—ì„œ:
1. Main Thread í™œì„±ë„
   - 100% ì°¬ êµ¬ê°„ = ë³‘ëª©
   
2. GPU ì‚¬ìš©ë¥ 
   - ì´ë¯¸ì§€ ë Œë”ë§ ë¶€í•˜

3. Hangs (ë²„ë²…ì„)
   - ë¹¨ê°„ ë§‰ëŒ€ = UI í”„ë¦¬ì§•

4. ì»¤ìŠ¤í…€ Signpost êµ¬ê°„
   - ìš°ë¦¬ê°€ ì‹¬ì–´ë‘” ì¸¡ì • ë§ˆì»¤
```

---

## ğŸ’¡ Instruments ê¿€íŒ

### 1. ë¹„êµ ì‹¤í–‰
```
File > Recording Options > 
ë‘ ê°œì˜ ê¸°ê¸°/ì‹œë®¬ë ˆì´í„° ë™ì‹œ ì¸¡ì • ê°€ëŠ¥
```

### 2. íŠ¹ì • êµ¬ê°„ë§Œ í™•ì¸
```
íƒ€ì„ë¼ì¸ì—ì„œ ë“œë˜ê·¸ë¡œ êµ¬ê°„ ì„ íƒ
â†’ ìš°í´ë¦­ â†’ "Focus on Selection"
```

### 3. ì¸¡ì •ê°’ ë‚´ë³´ë‚´ê¸°
```
File > Export > 
CSV ë˜ëŠ” XMLë¡œ ì €ì¥ í›„ ì—‘ì…€ ë¶„ì„
```

### 4. ì»¤ìŠ¤í…€ Instrument
```
File > Recording Options > os_signpost
"com.study.day01" subsystem ì²´í¬
â†’ ìš°ë¦¬ ë¡œê·¸ë§Œ í•„í„°ë§
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ì²« ì‹¤í–‰ ì œì™¸**: ì•± ì‹œì‘ ì§í›„ëŠ” ìºì‹œê°€ ì—†ì–´ì„œ ëŠë¦¼ â†’ 2íšŒì°¨ ì¸¡ì • ì‚¬ìš©
2. **ë°°í„°ë¦¬ ì¶©ì „ ìƒíƒœ**: ë°°í„°ë¦¬ ì„¸ì´ë²„ ëª¨ë“œë©´ ì„±ëŠ¥ ì œí•œë¨
3. **ë°±ê·¸ë¼ìš´ë“œ ì•±**: ë‹¤ë¥¸ ì•± ì¢…ë£Œí•˜ê³  ì¸¡ì •
4. **ê¸°ê¸° ì˜¨ë„**: ê³¼ì—´ë˜ë©´ ì“°ë¡œí‹€ë§ ë°œìƒ â†’ ì‹íŒ í›„ ì¬ì¸¡ì •
5. **ì‹œë®¬ë ˆì´í„° ê¸ˆì§€**: ë°˜ë“œì‹œ ì‹¤ê¸°ê¸°ì—ì„œ!

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Apple Instruments Help](https://help.apple.com/instruments/)
- [WWDC - Explore UI animation hitches and the render loop](https://developer.apple.com/videos/play/wwdc2020/10077/)
- [WWDC - Using Time Profiler](https://developer.apple.com/videos/play/wwdc2016/418/)

