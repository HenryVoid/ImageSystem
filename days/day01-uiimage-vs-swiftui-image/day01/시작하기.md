# 🚀 UIKit vs SwiftUI 이미지 성능 비교 - 시작하기

## 🎯 빠른 시작

### Release 모드로 전환 (30초)

```
Xcode > Product > Scheme > Edit Scheme...
Run > Info > Build Configuration > Release
```

⚠️ **필수**: Debug 모드는 최적화가 꺼져있어서 성능이 부정확합니다!

---

### 실기기에서 실행 (1분)

```
1. iPhone USB 연결
2. 상단 바에서 디바이스 선택
3. ▶️ 버튼 또는 ⌘R
4. 앱에서 SwiftUI/UIKit 탭 전환하며 테스트!
```

**확인 사항**:
- 우측 상단: FPS (초록/빨강)
- 좌측 상단: 메모리 사용량
- 스크롤 부드러움 체감

---

## 📊 성능 측정 방법 3가지

### 방법 1: 앱 화면에서 직접 확인 (가장 쉬움)

```
✅ 장점: 즉시 확인 가능, 시각적
❌ 단점: 정밀하지 않음

사용법:
1. 앱 실행
2. SwiftUI 탭 → 스크롤
   - FPS 확인 (60 fps가 목표)
   - 메모리 확인
3. UIKit 탭 → 스크롤
   - 동일하게 확인
4. 비교!
```

---

### 방법 2: Console.app으로 로그 분석 (실용적)

```
✅ 장점: 상세한 로그, 저장 가능
❌ 단점: 추가 앱 필요

사용법:
1. Console.app 실행
2. 필터: subsystem:com.study.day01
3. 앱에서 테스트
4. 로그 저장 (⌘S)
5. 분석!

확인 내용:
- 스크롤 시작/종료 타이밍
- FPS 추이 (1초마다)
- 메모리 변화량
- 탭 전환 시 메모리 해제 여부
```

👉 상세 가이드: [CONSOLE_APP_GUIDE.md](./day01/CONSOLE_APP_GUIDE.md)

---

### 방법 3: Instruments로 정밀 측정 (전문가용)

```
✅ 장점: 가장 정확, 그래프, CPU/GPU/메모리 모두
❌ 단점: 학습 필요, 시간 소요

사용법:
1. Xcode > Product > Profile (⌘I)
2. 템플릿 선택:
   - Time Profiler: CPU 사용률
   - Allocations: 메모리 할당
   - os_signpost: 우리가 심은 마커들!
3. 녹화 → 테스트 → 분석

확인 내용:
- SwiftUI_Scroll vs UIKit_Scroll 구간
- CPU 시간 비교
- 메모리 피크 비교
- 프레임 드롭 구간
```

👉 상세 가이드: [INSTRUMENTS_GUIDE.md](./day01/INSTRUMENTS_GUIDE.md)

---

## 🛠️ 구현된 도구 설명

### 1️⃣ PerformanceLogger.swift
```swift
// 사용법
PerformanceLogger.log("앱 시작")
PerformanceLogger.log("스크롤 시작", category: "scroll")
```
- **목적**: 통합 로깅 시스템
- **연동**: Console.app, Instruments
- **카테고리**: bench, scroll, fps, memory

---

### 2️⃣ SignpostHelper.swift
```swift
// 사용법
Signpost.swiftUIRender.begin()
// 작업...
Signpost.swiftUIRender.end()

// 또는 클로저로
Signpost.imageLoad.measure {
    return heavyOperation()
}
```
- **목적**: 구간 타이밍 측정
- **연동**: Instruments의 os_signpost
- **시각화**: 타임라인 그래프로 확인

---

### 3️⃣ FPSOverlay.swift
```swift
// 사용법
ScrollView {
    // 내용...
}
.showFPS() // 이게 끝!
```
- **목적**: 실시간 FPS 표시
- **색상**: 초록(60fps) → 빨강(30fps 이하)
- **위치**: 화면 우측 상단

---

### 4️⃣ ScrollDetector.swift
```swift
// SwiftUI
ScrollView {
    // 내용...
}
.coordinateSpace(name: "scroll")
.detectScrollWithSignpost(name: "List")

// UIKit
scrollView.delegate = scrollDetector
```
- **목적**: 스크롤 시작/종료 자동 감지
- **연동**: Signpost와 자동 연결
- **정확도**: UIKit이 더 정확

---

### 5️⃣ MemorySampler.swift
```swift
// 로그
MemorySampler.logCurrentMemory(label: "시작")

// 변화량 측정
let delta = MemorySampler.measureMemoryDelta {
    loadImages()
}

// 오버레이
.showMemory() // 실시간 표시
```
- **목적**: 메모리 사용량 측정
- **기술**: mach_task_basic_info 사용
- **단위**: MB 단위로 표시

---

## 📁 파일 구조

```
day01/
├── 📱 앱 파일
│   ├── day01App.swift              # 진입점
│   ├── BenchRootView.swift         # 메인 화면
│   ├── ImageList.swift             # 실제 테스트 구현
│   ├── ContentView.swift           # 예시 화면
│   └── UIKitImageView.swift        # UIKit 예시
│
├── 🛠️ 성능 측정 도구
│   ├── PerformanceLogger.swift     # 1) 로거
│   ├── SignpostHelper.swift        # 2) 사인포스트
│   ├── FPSOverlay.swift           # 3) FPS
│   ├── ScrollDetector.swift       # 4) 스크롤 감지
│   ├── MemorySampler.swift        # 5) 메모리
│   └── QuickStart.swift           # 사용 예시
│
└── 📚 가이드 문서
    ├── README.md                  # 전체 개요
    ├── XCODE_SETUP.md            # Xcode 설정
    ├── CONSOLE_APP_GUIDE.md      # 8) Console.app
    ├── INSTRUMENTS_GUIDE.md      # 6) Instruments
    └── 시작하기.md               # 이 파일
```

---

## 🎯 측정 항목

실제 테스트 후 다음 표를 채우세요:

| 항목 | SwiftUI | UIKit | 우승자 |
|------|---------|-------|--------|
| **평균 FPS** | ? | ? | ? |
| **최소 FPS** | ? | ? | ? |
| **평균 메모리** | ? | ? | ? |
| **최대 메모리** | ? | ? | ? |
| **스크롤 응답 시간** | ? | ? | ? |
| **CPU 사용률** | ? | ? | ? |

---

## 💡 측정 팁

### ✅ 해야 할 것

1. **여러 번 측정**: 첫 실행은 캐시가 없어서 느림
2. **평균내기**: 3~5회 측정 후 평균
3. **조건 통일**: 같은 기기, 같은 상태
4. **충전 상태**: 배터리 세이버 OFF
5. **기기 식히기**: 과열 시 쓰로틀링 발생

### ❌ 하지 말아야 할 것

1. **시뮬레이터**: 부정확함
2. **Debug 모드**: 최적화 OFF
3. **백그라운드 앱**: 다른 앱 종료
4. **첫 실행만 보기**: 비정상적으로 느림
5. **한 번만 측정**: 편차가 큼

---

## 🎓 기대 결과

### 예상 시나리오

#### 시나리오 1: 이미지 100장 (현재 설정)
```
예상:
- SwiftUI: 55~60 FPS
- UIKit: 58~60 FPS
→ 큰 차이 없음 (둘 다 괜찮음)
```

#### 시나리오 2: 이미지 500장
```
예상:
- SwiftUI: 45~55 FPS (LazyVStack 도움)
- UIKit: 50~60 FPS
→ UIKit이 약간 유리?
```

#### 시나리오 3: 이미지 1000장
```
예상:
- SwiftUI: 30~45 FPS (버벅임)
- UIKit: 45~55 FPS
→ UIKit이 유리
```

**실제로는?** 직접 측정해보세요! 🔬

---

## 🔥 고급 활용

### 이미지 개수 변경하기

```swift:ImageList.swift
// 100 → 500으로 변경
ForEach(0..<500, id: \.self) { index in
```

### 이미지 크기 변경하기

```swift:ImageList.swift
// 60 → 200으로 변경
.frame(height: 200)
```

### 다른 이미지 사용하기

```swift:ImageList.swift
// sample → yourImage로 변경
let image = UIImage(named: "yourImage")!
```

---

## 📞 도움말

### 문제가 생겼다면?

1. **빌드 에러**
   - Clean Build Folder (⌘⇧K)
   - 재빌드 (⌘B)
   - Xcode 재시작

2. **로그가 안 보임**
   - Console.app 필터 확인
   - subsystem 이름 확인
   - 앱 실행 중인지 확인

3. **FPS가 이상함**
   - Release 모드인지 확인
   - 실기기인지 확인
   - 다른 앱 종료

4. **Instruments가 복잡함**
   - 일단 Time Profiler만 사용
   - 간단한 테스트부터
   - 가이드 문서 참고

---

## 🎉 체크리스트

시작 전:
- [ ] Xcode 프로젝트에 파일 추가
- [ ] Release 모드로 전환
- [ ] 실기기 연결 및 서명
- [ ] 다른 앱 종료

측정 중:
- [ ] SwiftUI 탭 테스트 (3회)
- [ ] UIKit 탭 테스트 (3회)
- [ ] Console.app 로그 저장
- [ ] Instruments 프로파일링

측정 후:
- [ ] 평균값 계산
- [ ] 결과 표 작성
- [ ] 스크린샷 저장
- [ ] 결론 정리

---

## 🚀 지금 바로 시작하세요!

```bash
# 1. 프로젝트 열기
open day01.xcodeproj
# 2. Release 모드 전환
# 4. ▶️ 실행!
```

**Happy Benchmarking! 🎯**

---

## 📚 추가 학습 자료

- [Apple - Measuring Performance](https://developer.apple.com/documentation/xcode/measuring-performance)
- [WWDC - Demystify SwiftUI performance](https://developer.apple.com/videos/play/wwdc2023/10160/)
- [WWDC - Explore UI animation hitches](https://developer.apple.com/videos/play/wwdc2020/10077/)

---

질문이나 개선 사항이 있다면 이슈를 남겨주세요! 🙌

